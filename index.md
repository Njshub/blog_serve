## 笔记
## ======插件=======


为设计一个 博客系统，包括 前台 和 后台，你需要分别设计前台用户体验和后台管理系统。通常，前台提供给普通用户浏览、注册、发表文章等功能，而后台用于管理员管理内容，如文章、用户、评论等。

前台设计
前台是博客的主要展示部分，用户可以浏览文章、发表评论、注册账户等。以下是一些前台功能的设计思路：

1. 前台页面设计
主页（Home）: 展示最新或热门文章，提供文章分类、标签筛选、搜索功能等。
显示文章的列表，支持分页。
文章预览，包括标题、简介、封面、发布日期、作者、阅读量和评论数量等信息。
文章详情页（Article Detail）: 展示单篇文章的详细内容，包括作者信息、发布日期、评论等。
文章的内容展示、标签、分类
评论区，用户可以发表评论或回复其他用户。
点赞功能和文章浏览次数显示。
分类页面（Category Page）: 按照文章的分类展示文章列表。
通过分类筛选文章，按最新、热门等排序。
标签页面（Tag Page）: 按照文章的标签展示相关文章。
通过标签筛选相关文章。
用户注册/登录页面: 用户可以注册账号或登录已有账号。
包括基本的表单验证和错误提示。
用户注册后可以撰写文章、评论文章等。
用户个人中心（User Profile）: 用户可以管理自己的个人信息、查看自己的文章、管理评论等。
编辑个人信息如头像、邮箱、用户名。
查看自己发表的文章和评论。
搜索功能: 用户可以搜索文章，支持全文检索或基于标题、标签、分类等的检索。
2. 前台接口需求（与后端API交互）
用户相关: 注册、登录、登出、获取用户信息、修改用户信息。
文章相关: 获取文章列表、获取文章详情、发表文章、修改文章、删除文章。
分类与标签: 获取分类列表、标签列表、根据分类或标签筛选文章。
评论相关: 获取评论列表、发表评论、删除评论。
其他功能: 点赞文章、浏览次数统计、全局搜索。
后台设计
后台是管理员用于管理网站内容的部分，包括用户管理、文章管理、评论管理等。它通常会有一个专门的登录入口，只有拥有管理权限的用户可以访问。
1. 后台页面设计
<!-- 首页要做的 -->
控制面板（Dashboard）: 统计整个博客系统的状态，如总文章数、总用户数、评论数等。
# 显示一些统计数据，如网站浏览量、用户活跃情况。
# 展示最近发表的文章、评论等动态。
 # 2024/9/8号做 文章管理（Post Management）: 管理博客文章，可以查看、编辑、删除文章。 0 为不通过  1 文章通过
支持按分类、作者、状态筛选文章。
管理文章的草稿状态或发布状态。
支持批量删除文章。
分类管理（Category Management）: 增加、删除、修改文章分类。
管理分类名称、分类别名。
显示每个分类下的文章数量。
标签管理（Tag Management）: 增加、删除、修改文章标签。
管理标签名称、标签别名。
支持合并标签或删除无效标签。
评论管理（Comment Management）: 管理用户对文章的评论。
支持审核、删除评论。可以按文章、用户、时间等进行筛选。
用户管理（User Management）: 管理网站用户，可以查看、删除或禁用用户账号。
支持按用户名、邮箱等筛选用户。
设置用户的角色，如普通用户、作者、管理员。

2. 后台接口需求
# 2用户相关: 获取用户列表、禁用/启用用户、设置用户权限。
# 2文章管理: 获取文章列表、修改文章、删除文章、审核文章（发布、草稿状态）。
# 3分类与标签管理: 获取、添加、删除、修改分类和标签。
# 4评论管理: 获取评论列表、删除评论、审核评论。
# 5系统设置: 获取和更新博客的全局设置，如站点名称、描述、Logo等。
数据库设计（前台与后台共享）
前台和后台的数据共享，使用同一套数据库结构。数据库设计见前述数据库部分，以下是前台和后台如何使用该结构的解释：
前台: 普通用户和注册用户可以通过前台API进行文章浏览、评论和互动。注册用户可以撰写和管理自己的文章、评论。
后台: 管理员通过后台管理系统调用API接口对文章、用户、评论等进行全局管理，包括审核文章、审核评论等.

<!--   每个用户 是不是 发表文章，  删除， 添加   这些文章要跟根据用户ID 查询  page: 1 pageSize: 10  toatk: 100 -->
// 管理员登录
router.post('/login', async (req, res) => {
    const { email, password } = req.body;
    try {
        // 查找管理员用户
        const [rows] = await db.query('SELECT * FROM users WHERE email = ? AND role = 2', [email]);
        const user = rows[0];
        if (!user) {
            return res.status(403).json({ message: 'Admin access only' });
        }

        // 验证密码
        const isMatch = await bcrypt.compare(password, user.password);
        if (!isMatch) {
            return res.status(403).json({ message: 'Incorrect password' });
        }

        // 生成 JWT 令牌
        const token = jwt.sign({ id: user.id, role: user.role }, 'secret_key', { expiresIn: '1h' });
        res.json({ token });
    } catch (error) {
        res.status(500).json({ message: 'Server error' });
    }
});
